libname rat "\\utuhome.utu.fi\emaman";
 Data rotta;
	input oper treat rat loadver3 loadver4 loadver5 defver4 rigiver4;
	datalines;
    1    1    19      .    600    428  0.660   1159
    1    1    29    360    553    574  0.600   1098
    1    1    32    370    626    642  0.615   1217
    1    1    36    449    631    642  0.690   1107
    1    1    38    475    642    626  0.630   1159
    1    1    47    386    501    355  0.570   1087
    1    1    53    490    725    600  0.720   1210
    1    1    55    522    522    391  0.615   1044
    1    1    59    600    637    532  0.690   1070
    1    1    61    631    767    762  0.825   1199
    1    1    63    595    574    548  0.645   1098
    1    1    66    563    683    637  0.750   1159
    1    1    76    631    610    678  0.720   1098
    1    1    78    579    631    595  0.660   1159
    1    1    80    543    668    621  0.735   1210
    1    1    86    626    642    579  0.705   1113
    1    1    87    663    757    736  0.825   1204
    1    1    88    637    741    657  0.780   1159
    1    1    89    532    715    579  0.810   1159
    1    2    25    689    710    631      .   1228
    1    2    27    600    663    517  0.675   1159
    1    2    34    600    835    772      .   1199
    1    2    39    850    871    814      .   1325
    1    2    41    616    694    605  0.750   1113
    1    2    43      .    746    793  0.765   1204
    1    2    45    459    631    610  0.645   1159
    1    2    49    449    616    563  0.675   1107
    1    2    51    621    631    595  0.660   1159
    1    2    57    584    642    595  0.690   1107
    1    2    68    793    710    584  0.690   1512
    1    2    69    814    856    767  0.885   1199
    1    2    70    793    757    835  0.840   1070
    1    2    82    647    710    678  0.810   1159
    1    2    84    454    626    631  0.720   1113
    1    2    90    647    663    683  0.750   1113
    1    2    91    616    605    605  0.795    994
    1    2    93    590    678    558  0.705   1070
    1    2    95    710    918    678      .   1265
    1    2    97    751    840    652  0.855   1391
    1    3   121    558    527    417  0.615    994
    1    3   122    631    777    610  0.810   1199
    1    3   123    522    590    443  0.750   1242
    1    3   124    496    574    407  0.615   1098
    1    3   125    355    517    412  0.615   1098
    1    3   126    386    449    459  0.555   1023
    1    3   132    553    600    433  0.705   1159
    1    3   133    553    595    480  0.645   1159
    1    3   134    563    647    616  0.720   1113
    1    3   135    412    407    454  0.585    928
    1    3   136    579    574    600  0.630   1098
    1    3   137    595    631    668  0.750   1252
    1    3   138    553    642    454  0.660   1159
    1    3   139    600    683    710  0.735   1070
    1    3   140    668    605    506  0.645   1107
    1    3   141    626    459    579  0.525    966
    1    3   142    678    710    647  0.690   1159
    1    3   143    506    746    663  0.750   1304
    1    3   144    584    475    496  0.570   1070
    1    3   145    663    605    652  0.630   1159
    2    1    22    443    428    370  0.570    915
    2    1    24    600    657    605  0.540   1107
    2    1    35    590    558    574  0.690    949
    2    1    40      .    616    548      .   1098
    2    1    42    558    569    558  0.585   1159
    2    1    44    517    610    480  0.615   1159
    2    1    46    506    537    511  0.570   1159
    2    1    52    590    506    355  0.660    870
    2    1    54    506    365    417  0.585    870
    2    1    58    511    553    553  0.630   1098
    2    1    60    511    579    490  0.690   1044
    2    1    62    402    475    391  0.645    966
    2    1    71    490    590    595  0.690   1044
    2    1    72    537    464    527  0.645    966
    2    1    75    490    595    563  0.690   1107
    2    1    77    527    470    506  0.630    870
    2    1    79    543    642    522  0.630   1217
    2    1    92    590    517    563  0.630   1159
    2    1    94    475    470    407  0.585   1023
    2    1    96    673    803    574  0.810   1159
    2    2    11    767      .    856      .      .
    2    2    12    496    710    699  0.705   1159
    2    2    13    626    668    574  0.750   1070
    2    2    14    621    725    631  0.795   1044
    2    2    31    590    459    370  0.525   1087
    2    2    33    574    621    517  0.705   1107
    2    2    37    600    866    783  0.765   1242
    2    2    48    850    830    772  0.810   1199
    2    2    50    621    678    490  0.690   1159
    2    2    56    657    746    558      .   1281
    2    2    64    856    757    689  0.780   1118
    2    2    65    793    610    663  0.645   1159
    2    2    73    710    793    746  0.765   1242
    2    2    74    579    741    517  0.720   1204
    2    2    81    783    835    850  0.810   1423
    2    2    83    678    704    803  0.780   1113
    2    2    85    600    584    579      .      .
    2    2    98    871    657    683  0.750   1107
    2    2    99    657    610    720  0.705   1059
    2    2   100    715    725    730  0.750   1159
    2    3   146    517    621    496  0.720   1015
    2    3   147    459    443    303  0.525   1087
    2    3   148    610    626    511  0.735   1059
    2    3   149    532    490    417      .      .
    2    3   150    511    397    522  0.540    928
    2    3   151    621    480    517  0.690   1159
    2    3   157    631    725    470  0.795   1204
    2    3   158    574    621    741  0.870    840
    2    3   159    637    605    574  0.660    974
    2    3   160    480    673    579  0.765   1113
    2    3   161    454    626    443  0.795   1015
    2    3   162    657    657    694  0.675   1159
    2    3   163    616    501    454  0.780    745
    2    3   164    517    501    459  0.675    915
    2    3   165    610    673    569  0.720   1159
    2    3   166    621    746    631  0.780   1204
    2    3   167    496    423    376  0.525   1070
    2    3   168    605    683    657  0.660   1265
    2    3   169    683    616    704  0.735    898
    2    3   170    736    730    548  0.705   1087
;
run; 


proc univariate data=Rotta normal;
var defver4 loadver3;
title "normaalisuustesti";
run;

proc sgplot data = Rotta;
vbox loadver3 / category=oper;
title 'operaatio ja load3';
label oper = "operaatio" loadver3 = "voima, mikä tarvitaan aiheuttamaan lannenikamassa
murtuma"; 
run;

proc sgplot data = Rotta;
vbox defver4 / category=oper;
title 'operaatio ja defver4';
label oper = "operaatio" defver4 = "nikamassa ennen murtumista tapahtuva deformaatio
(paljonko se painuu kasaan) (millimetriä), nikama L4"; 
run;

proc sgplot data = Rotta;
vbox loadver3 / category=treat;
title 'treat ja load3';
label treat = "treat" loadver3 = "Käsittely tapa"; 
run;

proc sgplot data = Rotta;
vbox defver4  / category=treat;
title 'treat ja defver4';
label treat = "treat" defver4 = "nikamassa ennen murtumista tapahtuva deformaatio
(paljonko se painuu kasaan) (millimetriä), nikama L4"; 
run;



proc means data=Rotta
maxdec=3 fw=8;
class oper treat; 
var loadver3 defver4; 

run;

ods graphics on; 
proc glm data = Rotta plots=diagnostics;
class oper;
model defver4 = treat oper oper*treat /int ss3; 
run; 


proc glm data=Rotta plots=diagnostics;
class oper treat;
model loadver3 = oper treat oper*treat;
output out=levene2 r=residual2;
means oper treat oper*treat / hovtest=levene;
title "ANOVA loadver3";
run;

proc glm data=Rotta plots=diagnostics;
class oper treat;
model defver4 = oper treat oper*treat;
output out=levene1 r=residual1;
means oper treat oper*treat / hovtest=levene;
title "ANOVA defver4";
run;

data levene1; 
set levene1;
defver4=abs(residual1);
run; 
proc glm data=levene1;
class oper treat;
model defver4=oper treat oper*treat;
title "levene";
run;

data levene2; 
set levene2;
loadver3=abs(residual2);
run; 
proc glm data=levene2;
class oper treat;
model loadver3=oper treat oper*treat;
title "levene2";
run;


*EI yhdisvaikutusta;
proc glm data=Rotta;
class  treat;
model loadver3=treat;
title "marginaalikeskiarvot";
lsmeans treat / stderr pdiff cl; 
lsmeans treat / pdiff adjust = bon cl;
lsmeans treat / pdiff adjust = tukey cl;
estimate 'käs1-käs2' treat 1 -1 0;
estimate 'käs1-käs3' treat 1 0 -1;
estimate 'käs2-käs3' treat 0 1 -1;
run;

*YHdysvaikutus kyllä;
proc glm data=Rotta;
class  oper treat;
model defver4= oper treat oper*treat;
lsmeans treat / stderr pdiff cl; 
lsmeans treat / pdiff adjust = bon cl;
lsmeans treat / pdiff adjust = tukey cl;
title "Ruutukeskiarvot";
estimate 'oper1: käs1-käs2' treat 1 -1 0 oper*treat 1 -1 0 0 0 0;
estimate 'oper1: käs1-käs3' treat 1 0 -1 oper*treat 1 0 -1 0 0 0;
estimate 'oper1: käs2-käs3' treat 0 1 -1 oper*treat 0 1 -1 0 0 0;

estimate 'oper2: käs1-käs2' treat 1 -1 0 oper*treat 0 0 0 1 -1 0;
estimate 'oper2: käs1-käs3' treat 1 0 -1 oper*treat 0 0 0 1 0 -1;
estimate 'oper2: käs1-käs2' treat 0 1 -1 oper*treat 0 0 0 0 1 -1;
run;
